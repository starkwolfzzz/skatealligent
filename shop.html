<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skate Alligent - shop</title>
    <link rel="icon" type="image/png" href="images/black_Icon.png">
    <link rel="stylesheet" href="css/style.css">
    <link href="fontawesome-free-5.15.3-web/css/all.css" rel="stylesheet">
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js%27);
fbq('init', '950881942420079');
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=950881942420079&ev=PageView&noscript=1"
/></noscript>
<!-- End Facebook Pixel Code -->
</head>

<body>
    <div class="font_credit" style="display: none;">Font made from <a href="http://www.onlinewebfonts.com">oNline Web Fonts</a> is licensed by CC BY 3.0</div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mobile-detect/1.4.4/mobile-detect.min.js"></script>
    <div id="Sidenav" class="sidenav">
        <a class="closebtn" onclick="Nav()" style="cursor: pointer;">&times;</a>
        <div class="row" style="transition: 0.5s;">
            <div class="top-row">
                <a href="/shop.html?pg=1&special=Sale">EID-SALES</a>
            </div>
        </div>
        <div class="row" style="transition: 0.5s;">
            <div class="top-row">
                <a style="display: inline-block; flex-basis: 85%;" href="/shop.html?pg=1&category=Sports">SPORTS</a>
                <a style="flex-basis: 15%; cursor: pointer;" class="opennavlist" onclick="navList(this, '-155')">+</a>
            </div>
            <div class="bottom-row" style="margin-bottom: -155px;">
                <a class="subcate" href="/shop.html?pg=1&category=Sports&subcat=Longboards">Longboards</a>
                <a class="subcate" href="/shop.html?pg=1&category=Sports&subcat=Skateboards">Skateboards</a>
                <a class="subcate" href="/shop.html?pg=1&category=Sports&subcat=Pennyboards">Pennyboards</a>
                <a class="subcate" href="/shop.html?pg=1&category=Sports&subcat=Fingerboards">Fingerboards</a>
            </div>
        </div>
        <div class="row" style="transition: 0.5s;">
            <div class="top-row">
                <a class="subcate" style="display: inline-block; flex-basis: 85%;" href="/shop.html?pg=1&category=Protection">PROTECTION</a>
                <a class="subcate" style="flex-basis: 15%; cursor: pointer;" class="opennavlist" onclick="navList(this, '-85')">+</a>
            </div>
            <div class="bottom-row" style="margin-bottom: -85px;">
                <a class="subcate" href="/shop.html?pg=1&category=Protection&subcat=Helmets">Helmets</a>
                <a class="subcate" href="/shop.html?pg=1&category=Protection&subcat=Protective Pads">Protective Pads</a>
            </div>
        </div>
        <div class="row" style="transition: 0.5s;">
            <div class="top-row">
                <a style="display: inline-block; flex-basis: 85%;" href="/shop.html?pg=1&category=Components">COMPONENTS</a>
                <a style="flex-basis: 15%; cursor: pointer;" class="opennavlist" onclick="navList(this, '-295')">+</a>
            </div>
            <div class="bottom-row" style="margin-bottom: -295px;">
                <a class="subcate" href="/shop.html?pg=1&category=Components&subcat=Skate Decks">Skate Decks</a>
                <a class="subcate" href="/shop.html?pg=1&category=Components&subcat=Longboard Wheels">Longboard Wheels</a>
                <a class="subcate" href="/shop.html?pg=1&category=Components&subcat=Skateboard Wheels">Skateboard Wheels</a>
                <a class="subcate" href="/shop.html?pg=1&category=Components&subcat=Trucks">Trucks</a>
                <a class="subcate" href="/shop.html?pg=1&category=Components&subcat=Risers">Risers</a>
                <a class="subcate" href="/shop.html?pg=1&category=Components&subcat=Griptape">Griptape</a>
                <a class="subcate" href="/shop.html?pg=1&category=Components&subcat=Hardware">Hardware</a>
                <a class="subcate" href="/shop.html?pg=1&category=Components&subcat=Bushings">Bushings</a>
            </div>
        </div>
        <div class="row" style="transition: 0.5s;">
            <div class="top-row">
                <a href="/shop.html?pg=1&category=Tools">TOOLS</a>
            </div>
        </div>
        <div class="row" style="transition: 0.5s;">
            <div class="top-row">
                <a href="/account.html">ACCOUNT</a>
            </div>
        </div>
    </div>
    <div id="indexpage">
        <div class="header">
        <div class="container">
            <div class="navbar2" id="headerr" style="background-color: black; position: inherit;">
                <div class="logo-noline" id="logo">
                    <i class="fas fa-bars" style="cursor: pointer; transition: 0.5s ease; transform: translateY(-2px) translateX(5px); padding: 5px; color: white;" onclick="Nav()"></i><a class="logo" href="/" style="color: white;"> Skate Alligent</a>
                </div>
                <nav>
                    <ul id="menuItems">
                        <li><a href="/">Home</a></li>
                        <li><a href="/shop.html?pg=1" class="Active">shop</a></li>
                        <li><a href="/account.html">Account</a></li>
                        <li><a href="/contact.html">Contact</a></li>
                        <li><a href="/about.html">About</a></li>
                    </ul>
                </nav>
                <a href="/cart.html" class="button"><i class="fas fa-shopping-cart" aria-hidden="true" style="transform: scale(0.8); transition: 0.5s ease">
                        <?php
                        require('php/functions.php');
                        
                        if (!isset($_COOKIE["session"]) || checkSession($_COOKIE["session"]) == "session is incorrect") {
                            $cart = $_COOKIE['cart'];

                            if($cart != "" && $cart != null){
                                echo '<div style="position: absolute; margin-top: -14px; margin-left: 11px; border-radius: 50px; background-color: red; padding: 5px;"></div>';
                            }
                        } else {
                            require('php/connection.php');

                            $session = $_COOKIE['session'];

                            $sql = "SELECT * FROM users WHERE session = '" . $session . "';";
                            $query = mysqli_query($conn, $sql);
                            $rows = mysqli_num_rows($query);

                            if ($rows == 1) {
                                while ($row = mysqli_fetch_assoc($query)) {
                                    if($row['cart'] != ""){
                                        echo '<div style="position: absolute; margin-top: -14px; margin-left: 11px; border-radius: 50px; background-color: red; padding: 5px;"></div>';
                                    }
                                }
                            }
                        }
                        ?>
                    </i></a>
                <a class="menu-icon" onclick="menuToggle()"><i class="fas fa-bars" aria-hidden="true" style="transform: scale(0.8)"></i></a>
            </div>
        </div>
    </div>

    <!-- Filters
    <div class="filters-cont" style="height: 960px; transition: 0.5s; background: white;">
        <div class="row">
            <h1>Filters</h1>
            <a class="clearBtn" onclick="clearFilters()"><i class="fas fa-times-circle"></i> Clear</a>
        </div>
        <div class="row" style="transition: 0.5s;">
            <div class="top-row" onclick="minimizeFilter(this, '250')">
                <h3>Category</h3>
                <a><i class="fas fa-chevron-up"></i></a>
            </div>
            <div class="bottom-row">
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'category')">
                    <div class="fakeCheck" id="Completes"><a class="notChecked">&#9632;</a></div>
                    <label for="Completes">Completes</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'category')">
                    <div class="fakeCheck" id="Decks"><a class="notChecked">&#9632;</a></div>
                    <label for="Decks">Decks</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'category')">
                    <div class="fakeCheck" id="Wheels"><a class="notChecked">&#9632;</a></div>
                    <label for="Wheels">Wheels</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'category')">
                    <div class="fakeCheck" id="Trucks"><a class="notChecked">&#9632;</a></div>
                    <label for="Trucks">Trucks</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'category')">
                    <div class="fakeCheck" id="Hardware"><a class="notChecked">&#9632;</a></div>
                    <label for="Hardware">Hardware</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'category')">
                    <div class="fakeCheck" id="Bearings"><a class="notChecked">&#9632;</a></div>
                    <label for="Bearings">Bearings</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'category')">
                    <div class="fakeCheck" id="Griptape"><a class="notChecked">&#9632;</a></div>
                    <label for="Griptape">Griptape</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'category')">
                    <div class="fakeCheck" id="Risers"><a class="notChecked">&#9632;</a></div>
                    <label for="Risers">Risers</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'category')">
                    <div class="fakeCheck" id="Bushings"><a class="notChecked">&#9632;</a></div>
                    <label for="Bushings">Bushings</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'category')">
                    <div class="fakeCheck" id="Others"><a class="notChecked">&#9632;</a></div>
                    <label for="Others">Others</label>
                </div>
            </div>
        </div>
        <div class="row" style="transition: 0.5s;">
            <div class="top-row" onclick="minimizeFilter(this, '250')">
                <h3>Brand</h3>
                <a><i class="fas fa-chevron-up"></i></a>
            </div>
            <div class="bottom-row">
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'brand')">
                    <div class="fakeCheck" id="Enuff"><a class="notChecked">&#9632;</a></div>
                    <label for="Enuff">Enuff</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'brand')">
                    <div class="fakeCheck" id="Penny"><a class="notChecked">&#9632;</a></div>
                    <label for="Penny">Penny</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'brand')">
                    <div class="fakeCheck" id="Santa"><a class="notChecked">&#9632;</a></div>
                    <label for="Santa">Santa Cruz</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'brand')">
                    <div class="fakeCheck" id="Sector"><a class="notChecked">&#9632;</a></div>
                    <label for="Sector">Sector 9</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'brand')">
                    <div class="fakeCheck" id="Yocaher"><a class="notChecked">&#9632;</a></div>
                    <label for="Yocaher">Yocaher</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'brand')">
                    <div class="fakeCheck" id="Others"><a class="notChecked">&#9632;</a></div>
                    <label for="Others">Others</label>
                </div>
            </div>
        </div>
        <div class="row" style="transition: 0.5s; padding-bottom: 0px;">
            <div class="top-row" onclick="minimizeFilter(this, '250')">
                <h3>Size</h3>
                <a><i class="fas fa-chevron-down"></i></a>
            </div>
            <div class="bottom-row">
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'size')">
                    <div class="fakeCheck" id="7.4"><a class="notChecked">&#9632;</a></div>
                    <label for="7.4">7.4"</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'size')">
                    <div class="fakeCheck" id="7.6"><a class="notChecked">&#9632;</a></div>
                    <label for="7.6">7.6"</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'size')">
                    <div class="fakeCheck" id="7.8"><a class="notChecked">&#9632;</a></div>
                    <label for="7.8">7.8"</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'size')">
                    <div class="fakeCheck" id="8.0"><a class="notChecked">&#9632;</a></div>
                    <label for="8.0">8.0"</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'size')">
                    <div class="fakeCheck" id="8.125"><a class="notChecked">&#9632;</a></div>
                    <label for="8.125">8.125"</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'size')">
                    <div class="fakeCheck" id="8.25"><a class="notChecked">&#9632;</a></div>
                    <label for="8.25">8.25"</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'size')">
                    <div class="fakeCheck" id="8.5"><a class="notChecked">&#9632;</a></div>
                    <label for="8.5">8.5"</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'size')">
                    <div class="fakeCheck" id="8.75"><a class="notChecked">&#9632;</a></div>
                    <label for="8.75">8.75"</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'size')">
                    <div class="fakeCheck" id="9.0"><a class="notChecked">&#9632;</a></div>
                    <label for="9.0">9.0"</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'size')">
                    <div class="fakeCheck" id="9.25"><a class="notChecked">&#9632;</a></div>
                    <label for="9.25">9.25"</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'size')">
                    <div class="fakeCheck" id="9.5"><a class="notChecked">&#9632;</a></div>
                    <label for="9.5">9.5"</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'size')">
                    <div class="fakeCheck" id="10.0"><a class="notChecked">&#9632;</a></div>
                    <label for="10.0">10.0"</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'size')">
                    <div class="fakeCheck" id="10.5"><a class="notChecked">&#9632;</a></div>
                    <label for="10.5">10.5"</label>
                </div>
            </div>
        </div>
        <div class="row" style="transition: 0.5s; padding-bottom: 0px;">
            <div class="top-row" onclick="minimizeFilter(this, '250')">
                <h3>Color</h3>
                <a><i class="fas fa-chevron-down"></i></a>
            </div>
            <div class="bottom-row">
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'color')">
                    <div class="fakeCheck" id="Red"><a class="notChecked">&#9632;</a></div>
                    <label for="Red">Red</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'color')">
                    <div class="fakeCheck" id="Orange"><a class="notChecked">&#9632;</a></div>
                    <label for="Orange">Orange</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'color')">
                    <div class="fakeCheck" id="Yellow"><a class="notChecked">&#9632;</a></div>
                    <label for="Yellow">Yellow</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'color')">
                    <div class="fakeCheck" id="Green"><a class="notChecked">&#9632;</a></div>
                    <label for="Green">Green</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'color')">
                    <div class="fakeCheck" id="Blue"><a class="notChecked">&#9632;</a></div>
                    <label for="Blue">Blue</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'color')">
                    <div class="fakeCheck" id="Indigo"><a class="notChecked">&#9632;</a></div>
                    <label for="Indigo">Indigo</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'color')">
                    <div class="fakeCheck" id="Violet"><a class="notChecked">&#9632;</a></div>
                    <label for="Violet">Violet</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'color')">
                    <div class="fakeCheck" id="Others"><a class="notChecked">&#9632;</a></div>
                    <label for="Others">Others</label>
                </div>
            </div>
        </div>
        <div class="row" style="transition: 0.5s; padding-bottom: 0px;">
            <div class="top-row" onclick="minimizeFilter(this, '250')">
                <h3>Price</h3>
                <a><i class="fas fa-chevron-down"></i></a>
            </div>
            <div class="bottom-row">
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'price')">
                    <div class="fakeCheck" id="0"><a class="notChecked">&#9632;</a></div>
                    <label for="0">Under EGP 1000</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'price')">
                    <div class="fakeCheck" id="1000"><a class="notChecked">&#9632;</a></div>
                    <label for="1000">EGP 1000 to EGP 2000</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'price')">
                    <div class="fakeCheck" id="2000"><a class="notChecked">&#9632;</a></div>
                    <label for="2000">EGP 2000 to EGP 3000</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'price')">
                    <div class="fakeCheck" id="3000"><a class="notChecked">&#9632;</a></div>
                    <label for="3000">EGP 3000 to EGP 4000</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'price')">
                    <div class="fakeCheck" id="4000"><a class="notChecked">&#9632;</a></div>
                    <label for="4000">EGP 4000 to EGP 5000</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'price')">
                    <div class="fakeCheck" id="5000"><a class="notChecked">&#9632;</a></div>
                    <label for="5000">Over EGP 5000</label>
                </div>
            </div>
        </div>
        <div class="row" style="transition: 0.5s; padding-bottom: 0px;">
            <div class="top-row" onclick="minimizeFilter(this, '100')">
                <h3>Stock</h3>
                <a><i class="fas fa-chevron-down"></i></a>
            </div>
            <div class="bottom-row">
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'stock')">
                    <div class="fakeCheck" id="In"><a class="notChecked">&#9632;</a></div>
                    <label for="In">In Stock</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'stock')">
                    <div class="fakeCheck" id="Out"><a class="notChecked">&#9632;</a></div>
                    <label for="Out">Out Of Stock</label>
                </div>
            </div>
        </div>
        <div class="row" style="transition: 0.5s; padding-bottom: 0px;">
            <div class="top-row" onclick="minimizeFilter(this, '100')">
                <h3>Special</h3>
                <a><i class="fas fa-chevron-down"></i></a>
            </div>
            <div class="bottom-row">
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'special')">
                    <div class="fakeCheck" id="New"><a class="notChecked">&#9632;</a></div>
                    <label for="New">New Arrivals</label>
                </div>
                <div class="checkbox-cat" id="" onclick="addFilter(this, 'special')">
                    <div class="fakeCheck"><a class="notChecked">&#9632;</a></div>
                    <label for="Sale">Sale</label>
                </div>
            </div>
        </div>
    </div> -->

    <!-- Products -->
    <div class="small-container" style="background: white; border: 1px solid black; margin-top: 100px; margin-bottom: 100px;">
        <div class="row row-2">
            <h2>All Products</h2>
            <div class="search-con">
                <form onsubmit="return false;">
                    <input type="text" id="Searchbar" placeholder="Search..." title="Enter a term to search through the products">
                    <button type="submit" onclick="searchBar(this)"><i class="fa fa-search"></i></button>
                </form>
            </div>
            <select id="sortingSelect" onchange="setSorting(value)" name="Sort By:">
                <option>Default Sorting</option>
                <option>Name: (A to Z)</option>
                <option>Name: (Z to A)</option>
                <option>Price: (Low to High)</option>
                <option>Price: (High to Low)</option>
            </select>
        </div>

        <?php
        require_once('php/connection.php');
        require_once('php/functions.php');

        $url = (isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] === 'on' ? "https" : "http") . "://$_SERVER[HTTP_HOST]$_SERVER[REQUEST_URI]";

        $url_components = parse_url($url);
        parse_str($url_components['query'], $params);

        $sql;
        $fullStr;

        if($params['q'] != null || $params['category'] != null || $params['brand'] != null || $params['size'] != null || $params['color'] != null || $params['price'] != null || $params['stock'] != null || $params['special'] != null || $params['sort'] != null){
            
            $fullStr = "WHERE ";

            if($params['q'] != null){
                $fullStr = $fullStr . "Name LIKE '%" . $params['q'] . "%' AND ";
            }

            if($params['category'] != null){
                $categories = str_replace(' ', ", ", $params['category']);
                
                $categories = str_replace('caOthers', "Others", $categories);

                if(strpos($categories, ',') != null){
                    $list = explode(', ',$categories);
    
                    for ($i = 0; $i < sizeof($list); $i++) { 
                        if($i < sizeof($list) - 1)
                        {
                            $fullStr = $fullStr . "Category = '" . $list[$i] . "' OR ";
                        } else {
                            $fullStr = $fullStr . "Category = '" . $list[$i] . "' AND ";
                        }
                    }
                } else {
                    $fullStr = $fullStr . "Category = '" . $categories . "' AND ";
                }
            }

            if($params['subcat'] != null){
                $categories = urlencode($params['subcat']);
                $categories = str_replace(' ', ", ", $categories);
                $categories = urldecode($categories);

                if(strpos($categories, ',') != null){
                    $list = explode(', ',$categories);
    
                    for ($i = 0; $i < sizeof($list); $i++) { 
                        if($i < sizeof($list) - 1)
                        {
                            $fullStr = $fullStr . "Category = '" . $list[$i] . "' OR ";
                        } else {
                            $fullStr = $fullStr . "Category = '" . $list[$i] . "' AND ";
                        }
                    }
                } else {
                    $fullStr = $fullStr . "Subcategory = '" . $categories . "' AND ";
                }
            }

            /*if($params['brand'] != null){
                $brands = str_replace(' ', ", ", $params['brand']);

                $brands = str_replace('Santa, Cruz', "Santa Cruz", $brands);
                $brands = str_replace('Sector, 9', "Sector 9", $brands);
                $brands = str_replace('brOthers', "Others", $brands);

                if(strpos($brands, ',') != null){
                    $list = explode(', ',$brands);
    
                    for ($i = 0; $i < sizeof($list); $i++) { 
                        if($i < sizeof($list) - 1)
                        {
                            $fullStr = $fullStr . "Brand = '" . $list[$i] . "' OR ";
                        } else {
                            $fullStr = $fullStr . "Brand = '" . $list[$i] . "' AND ";
                        }
                    }
                } else {
                    $fullStr = $fullStr . "Brand = '" . $brands . "' AND ";
                }
            }

            if($params['size'] != null){
                $sizes = str_replace(' ', ", ", $params['size']);
                if(strpos($sizes, ',') != null){
                    $list = explode(', ',$sizes);
    
                    for ($i = 0; $i < sizeof($list); $i++) { 
                        if($i < sizeof($list) - 1)
                        {
                            $fullStr = $fullStr . "Sizes LIKE '%" . $list[$i] . "%' OR ";
                        } else {
                            $fullStr = $fullStr . "Sizes LIKE '%" . $list[$i] . "%' AND ";
                        }
                    }
                } else {
                    $fullStr = $fullStr . "Sizes LIKE '%" . $sizes . "%' AND ";
                }
            }

            if($params['color'] != null){
                $colors = str_replace(' ', ", ", $params['color']);

                $colors = str_replace('coOthers', "Others", $colors);

                if(strpos($colors, ',') != null){
                    $list = explode(', ',$colors);
    
                    for ($i = 0; $i < sizeof($list); $i++) { 
                        if($i < sizeof($list) - 1)
                        {
                            $fullStr = $fullStr . "Colors LIKE '%" . $list[$i] . "%' OR ";
                        } else {
                            $fullStr = $fullStr . "Colors LIKE '%" . $list[$i] . "%' AND ";
                        }
                    }
                } else {
                    $fullStr = $fullStr . "Colors LIKE '%" . $colors . "%' AND ";
                }
            }

            if($params['price'] != null){
                $prices = str_replace(' ', ", ", $params['price']);

                $prices = str_replace('Under, EGP, 1000', "Under EGP 1000", $prices);
                $prices = str_replace('EGP, 1000, to, EGP, 2000', "EGP 1000 to EGP 2000", $prices);
                $prices = str_replace('EGP, 2000, to, EGP, 3000', "EGP 2000 to EGP 3000", $prices);
                $prices = str_replace('EGP, 3000, to, EGP, 4000', "EGP 3000 to EGP 4000", $prices);
                $prices = str_replace('EGP, 4000, to, EGP, 5000', "EGP 4000 to EGP 5000", $prices);
                $prices = str_replace('Over, EGP, 5000', "Over EGP 5000", $prices);

                if(strpos($prices, ',') != null){
                    $list = explode(', ', $prices);
    
                    for ($i = 0; $i < sizeof($list); $i++) { 
                        if($i < sizeof($list) - 1)
                        {
                            if($list[$i] == "Under EGP 1000") $fullStr = $fullStr . "Price < 1000 OR ";
                            else if($list[$i] == "EGP 1000 to EGP 2000") $fullStr = $fullStr . "Price BETWEEN 1000 and 2000 OR ";
                            else if($list[$i] == "EGP 2000 to EGP 3000") $fullStr = $fullStr . "Price BETWEEN 2000 and 3000 OR ";
                            else if($list[$i] == "EGP 3000 to EGP 4000") $fullStr = $fullStr . "Price BETWEEN 3000 and 4000 OR ";
                            else if($list[$i] == "EGP 4000 to EGP 5000") $fullStr = $fullStr . "Price BETWEEN 4000 and 5000 OR ";
                            else if($list[$i] == "Over EGP 5000") $fullStr = $fullStr . "Price > 5000 AND ";
                        } else {
                            if($list[$i] == "Under EGP 1000") $fullStr = $fullStr . "Price < 1000 AND ";
                            else if($list[$i] == "EGP 1000 to EGP 2000") $fullStr = $fullStr . "Price BETWEEN 1000 and 2000 AND ";
                            else if($list[$i] == "EGP 2000 to EGP 3000") $fullStr = $fullStr . "Price BETWEEN 2000 and 3000 AND ";
                            else if($list[$i] == "EGP 3000 to EGP 4000") $fullStr = $fullStr . "Price BETWEEN 3000 and 4000 AND ";
                            else if($list[$i] == "EGP 4000 to EGP 5000") $fullStr = $fullStr . "Price BETWEEN 4000 and 5000 AND ";
                            else if($list[$i] == "Over EGP 5000") $fullStr = $fullStr . "Price > 5000 AND ";
                        }
                    }
                } else {
                    if($prices == "Under EGP 1000") $fullStr = $fullStr . "Price < 1000 AND ";
                    else if($prices == "EGP 1000 to EGP 2000") $fullStr = $fullStr . "Price BETWEEN 1000 and 2000 AND ";
                    else if($prices == "EGP 2000 to EGP 3000") $fullStr = $fullStr . "Price BETWEEN 2000 and 3000 AND ";
                    else if($prices == "EGP 3000 to EGP 4000") $fullStr = $fullStr . "Price BETWEEN 3000 and 4000 AND ";
                    else if($prices == "EGP 4000 to EGP 5000") $fullStr = $fullStr . "Price BETWEEN 4000 and 5000 AND ";
                    else if($prices == "Over EGP 5000") $fullStr = $fullStr . "Price > 5000 AND ";
                }
            }

            if($params['stock'] != null){
                $stocks = str_replace(' ', ", ", $params['stock']);
                
                $stocks = str_replace('In, Stock', "In Stock", $stocks);
                $stocks = str_replace('Out, Of, Stock', "Out Of Stock", $stocks);

                if(strpos($stocks, ',') != null){
                    $list = explode(', ', $stocks);    
                    for ($i = 0; $i < sizeof($list); $i++) { 
                        if($i < sizeof($list) - 1)
                        {
                            if($list[$i] == "In Stock") $fullStr = $fullStr . "Stock > 0 OR ";
                            else if($list[$i] == "Out Of Stock") $fullStr = $fullStr . "Stock = 0 OR ";
                        } else {
                            if($list[$i] == "In Stock") $fullStr = $fullStr . "Stock > 0 AND ";
                            else if($list[$i] == "Out Of Stock") $fullStr = $fullStr . "Stock = 0 AND ";
                        }
                    }
                } else {
                    if($stocks == "In Stock") $fullStr = $fullStr . "Stock > 0 AND ";
                    else if($stocks == "Out Of Stock") $fullStr = $fullStr . "Stock = 0 AND ";
                }
            }*/

            $newArrive = 0;

            if($params['special'] != null){
                $special = str_replace(' ', ", ", $params['special']);
                
                $special = str_replace('New, Arrivals', "New Arrivals", $special);

                if(strpos($special, ',') != null){
                    $list = explode(', ', $special);    
                    for ($i = 0; $i < sizeof($list); $i++) { 
                        if($list[$i] == "Sale") $fullStr = $fullStr . "Sale > 0 AND ";
                        else if($list[$i] == "New Arrivals") $newArrive = 1;
                    }
                } else {
                    if($special == "Sale") $fullStr = $fullStr . "Sale > 0 AND ";
                    else if($special == "New Arrivals") $newArrive = 1;
                }
            }

            if(strrpos($fullStr, "D") + 2 == strlen($fullStr)) $fullStr = substr($fullStr, 0, strrpos($fullStr, "AND") - 1);

            if($newArrive == 0)
            {
                if($params['sort'] != null){
                    $vari = $params['sort'];

                    if($vari == "Name: (A to Z)") $fullStr = $fullStr . " ORDER BY Name";
                    else if($vari == "Name: (Z to A)") $fullStr = $fullStr . " ORDER BY Name DESC";
                    else if($vari == "Price: (Low to High)") $fullStr = $fullStr . " ORDER BY Price";
                    else if($vari == "Price: (High to Low)") $fullStr = $fullStr . " ORDER BY Price DESC";
                }
            } else if ($newArrive == 1){
                $fullStr = $fullStr . " ORDER BY ID DESC";
            }

            if(strpos($fullStr, "W") != null || strpos($fullStr, "W") == 0) {
                $fullStr = str_replace('WHERE  ', "", $fullStr);
            }

            echo '<div style="display: none;"> ' . $fullStr . ' </div>';

        }

        $sql = "SELECT * FROM Products " . $fullStr . ";";

        $result = mysqli_query($conn, $sql);
        $resultCheck = mysqli_num_rows($result);
        $num = 1;

        $numOfRows = 0;

        $addedDiv = 0;

        $iteration = 0;

        if ($params['pg'] == 1) {
            $numOfRows = 0;
        } else {
            $numOfRows = intval($params['pg'] - 1) * 4;
        }

        $onmouseover = "onmouseover = 'changeImage(";
        $pt2 = 'this, "change")';
        $colon2 = "'";

        $onmouseout = "onmouseout = 'changeImage(";
        $pt22 = 'this, "default")';

        if ($resultCheck > 0) {
            while ($row = mysqli_fetch_assoc($result)) {
                if ($iteration >= intval($numOfRows * 4)) {
                        if (intval($num - 1) % 4 == 0 || $num == 1) {
                            echo '<div class="row">';
                            $addedDiv = 0;
                        }
                        echo '<div class="col-4" style="cursor: pointer; text-align: center;"><a href="/product.html?id=' . $row['ID'] . '">';
                        echo "<img src='products/" . $row['ID'] . ".png'>";
                        
                        if($row['Sale'] != 0){
                            echo '<img style="position: absolute; width: 23%; top: 0; left: 0;" src="images/sale.png">';
                        }

                        echo "<div class='prodnamediv2'><h4 style='font-weight: bold;'>" . $row['Name'] . "</h4></div>";

                        if($row['Stock'] > 0){
                            echo "<p style='color: limegreen;'>In Stock</p>";
                        } else if ($row['Stock'] == 0) {
                            echo "<p style='color: red;'>Out Of Stock</p>";
                        }
                        
                        if ($row['Sale'] != 0) {
                            echo "<p style='text-decoration: none; color: black; display: inline;'>EGP " . intval(intval($row['Price']) - intval($row['Sale'])) . "</p> <p style='text-decoration: line-through; color: gray; display: inline;'>EGP " . $row['Price'] . "</p>";
                        } else {
                            echo "<p style='text-decoration: none; color: black;'>EGP " . $row['Price'] . "</p>";
                        }
                        echo '<div id="prod-overlay"></div><a href="/product.html?id=' . $row['ID'] . '" id="prod-overlay-a">VIEW</a>';
                        echo "</div>";

                        $num += 1;
                        if (intval($num - 1) % 4 == 0 || $num == 1) {
                            echo "</a></div>";
                            $addedDiv = 1;
                            $numOfRows += 1;
                        }

                    $iteration++;

                    if ($numOfRows == 4 * $params['pg']) {
                        break;
                    }
                } else {
                    $iteration++;
                }
            }
            if($addedDiv == 0){
                echo "</a></div>";
            }
        } else {
            echo "<div class='row'>";
                echo '<h2 style="margin-top: 100px; margin-bottom: 400px; color: black;">There are no products available with the current filters.</h2>';
            echo "</div>";
        }

        echo '<div id="numberOfRows" style="display: none;">' . $resultCheck . '</div>';
        ?>

            <div class="page-btn" style="text-align: right;">
                <span onclick="nextPage(-1)" class="arrow-btn" id="invisible">&#8592;</span>
                <span onclick="nextPage(1)" class="arrow-btn" id="visible">&#8594;</span>
            </div>
    </div>

    <!--- Cookie Notice --->
        <div class="cookies" style="visibility: hidden">
            <div class="container">
                <div class="row">
                    <div class="col-2" style="text-align: right; color: white; font-size: 1vw;">
                        <p>We use cookies to enhance your experience with our website.</p>
                        <p>By continuing to use the site, you agree to the use of cookies.</p>
                    </div>
                    <div class="col-2" style="text-align: left; font-size: 1vw;">
                        <a class="cookie-btn" id="link" onclick="acceptCookies()" style="color: white;">Accept Cookies</a>
                        <a class="cookie-btn" id="link" href="/cookie-policy.html" style="color: white;">Learn More</a>
                    </div>
                </div>
            </div>
        </div>


    <!--- Footer --->
    <div class="footer" id="sec4">
        <div class="container">
            <div class="row">
                <div class="footer-col-1">
                    <a href="/index.html">
                        <img class="footerlogo" src="images/Logo.png">
                    </a>
                </div>
                <div class="footer-col-2">
                    <h3>Useful Links</h3>
                    <ul>
                        <li><a href="/account.html" id="linka"><i class="fas fa-user"></i> My Account</a></li>
                        <li><a href="/cart.html" id="linka"><i class="fas fa-shopping-cart"></i> Shopping Cart</a></li>
                        <li><a href="/refund-policy.html" id="linka"><i class="fas fa-money-bill"></i> Refund Policy</a></li>
                        <li><a href="/about.html" id="linka"><i class="fas fa-users"></i> About Us</a></li>
                    </ul>
                </div>
                <div class="footer-col-3">
                    <h3>Follow Us</h3>
                    <ul>
                        <li><a href="https://www.facebook.com/alligentskateshop" target="_blank" rel="noopener noreferrer" id="linka"><i class="fab fa-facebook"></i> Facebook</a></li>
                            <li><a href="https://www.instagram.com/skatealligent/?hl=en" target="_blank" rel="noopener noreferrer" id="linka"><i class="fab fa-instagram"></i> Instagram</a></li>
                    </ul>
                </div>
            </div>
            <hr>
            <p class="copyright" style="margin-bottom: 15px;">Â© 2021 <a class="linka" href="/index.html">Skate Alligent</a>. All rights reserved.</p>
            <p class="copyright"><a class="linka" href="/terms-of-use.html">Terms of use </a> | <a class="linka" href="/privacy-policy.html"> Privacy Policy</a></p>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // <-- Menu -->
        var MenuItems = document.getElementById("menuItems");

        MenuItems.style.maxHeight = "0px";

        function menuToggle() {
            if (MenuItems.style.maxHeight == "0px") {
                MenuItems.style.maxHeight = "200px";
            } else {
                MenuItems.style.maxHeight = "0px";
            }
        }

        // <-- Subcat -->
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        const subcat = urlParams.get('subcat');
        var linkss = document.getElementsByClassName("subcate");

        for(i = 0; i < linkss.length; i++){
            if(linkss[i].innerHTML == subcat) linkss[i].classList.add("subcatLinkActive");
        }

        // <-- Page Number -->
        let arrowButtons = document.getElementsByClassName('arrow-btn');
        createPages();
        let buttons = document.getElementsByClassName('page-btns');
        const pageNO = urlParams.get('pg');

        function createPages() {
            let parenttt = document.getElementsByClassName('page-btn')[0];
            var noOfProdsObj = document.getElementById('numberOfRows');
            var noOfProds = document.getElementById('numberOfRows').textContent;

            var modulo = noOfProds % 16;
            var vari = parseInt(noOfProds - modulo) / 16;
            var number = vari;
            if (modulo > 0) {
                number = vari + 1;
            }

            if(vari == 0){
                number = 1;
            }

            for (i = 0; i < number; i++) {
                var aElem = document.createElement("A");
                aElem.href = "/shop.html?pg=1";
                parenttt.insertBefore(aElem, arrowButtons[1]);

                var spanElem = document.createElement("SPAN");
                spanElem.className = "page-btns";
                spanElem.id = "page-btn";
                spanElem.textContent = i + 1;
                aElem.appendChild(spanElem);
            }

            noOfProdsObj.remove();
        }

        for (i = 0; i < buttons.length; i++) {
            buttons[i].parentElement.href = "shop.html?pg=" + parseInt(i + 1) + urlParams.toString().replace("pg=" + pageNO, "");
        }

        if (pageNO == null || pageNO > buttons.length || isNaN(pageNO) || parseInt(pageNO) <= 0 || pageNO == "") {
            if (urlParams.toString().substring(urlParams.toString().indexOf("&"), urlParams.toString().length) != null && urlParams.toString().substring(urlParams.toString().indexOf("&"), urlParams.toString().length) != "" && !urlParams.toString().substring(urlParams.toString().indexOf("&"), urlParams.toString().length).includes("pg")) {
                location.replace("/shop.html?pg=1" + urlParams.toString().substring(urlParams.toString().indexOf("&"), urlParams.toString().length));
            } else {
                location.replace("/shop.html?pg=1");
            }
        }

        for (i = 0; i < buttons.length; i++) {
            if (i == pageNO - 1) {
                buttons[i].id = 'page-btn-active';
            } else {
                buttons[i].id = 'page-btns';
            }
        }

        if (pageNO == 1) {
            arrowButtons[0].id = "invisible";
            arrowButtons[1].id = "visible";
        }
        if (pageNO > 1) {
            arrowButtons[0].id = "visible";
            arrowButtons[1].id = "visible";
        }
        if (pageNO == buttons.length) {
            arrowButtons[0].id = "visible";
            arrowButtons[1].id = "invisible";
        }

        if (buttons.length == 1 || buttons.length == 0) {
            arrowButtons[0].id = "invisible";
            arrowButtons[1].id = "invisible";
        }

        function nextPage(n) {
            if (n == 1) {
                var nextpage = parseInt(pageNO) + 1;
                if (nextpage > buttons.length) {
                    nextpage = 1;
                }
                if (!urlParams.toString().substring(urlParams.toString().indexOf("&"), urlParams.toString().length).includes("pg")) {
                    location.href = "/shop.html?pg=" + nextpage + urlParams.toString().substring(urlParams.toString().indexOf("&"), urlParams.toString().length);
                } else {
                    location.href = "/shop.html?pg=" + nextpage;
                }
            } else {
                var lastpage = parseInt(pageNO) - 1;
                if (lastpage < 1) {
                    lastpage = 4;
                }
                if (!urlParams.toString().substring(urlParams.toString().indexOf("&"), urlParams.toString().length).includes("pg")) {
                    location.href = "/shop.html?pg=" + lastpage + urlParams.toString().substring(urlParams.toString().indexOf("&"), urlParams.toString().length);
                } else {
                    location.href = "/shop.html?pg=" + lastpage;
                }
            }
        }

        // <-- Sorting -->
        let dropdown = document.getElementById("sortingSelect");
        checkSortValue();

        function checkSortValue() {
            if (urlParams.toString().includes("&sort=")) {
                var initial = urlParams.toString().substring(urlParams.toString().indexOf("&sort="), urlParams.toString().length);
                var final;

                final = initial;

                if (initial.includes("%3A") || initial.includes("%28") || initial.includes("%29")) {
                    final = initial.replaceAll("%3A", ":");
                    final = final.replaceAll("%28", "(");
                    final = final.replaceAll("%29", ")");
                }
                final = final.replaceAll("+", " ");

                if (nthIndexOf(initial, "&", 2) == undefined) {
                    dropdown.value = final.substring(final.indexOf("sort=") + 5, final.length);
                } else {
                    dropdown.value = final.substring(final.indexOf("sort=") + 5, nthIndexOf(final, "&", 2));
                }
            }
        }

        function setSorting(value) {
            if (value != "Default Sorting") {
                if (urlParams.toString().includes("&sort=")) {
                    var initial = urlParams.toString().substring(urlParams.toString().indexOf("&sort="), urlParams.toString().length);

                    if (nthIndexOf(initial, "&", 2) == undefined) {
                        location.replace("shop.html?" + urlParams.toString().replace(initial, "").replace("pg=" + pageNO, "pg=1") + "&sort=" + value);
                    } else {
                        location.replace("shop.html?" + urlParams.toString().replace(initial, "").replace("pg=" + pageNO, "pg=1") + "&sort=" + value + urlParams.toString().substring(nthIndexOf(initial, "&", 2) + urlParams.toString().indexOf(initial), urlParams.toString().length));
                    }
                } else {
                    if (urlParams.toString().includes("&q=")) {
                        var initial = urlParams.toString().substring(urlParams.toString().indexOf("&q="), urlParams.toString().length);

                        if (nthIndexOf(initial, "&", 2) == undefined) {
                            location.replace("shop.html?" + urlParams.toString().replace("pg=" + pageNO, "pg=1") + "&sort=" + value);
                        } else {
                            location.replace("shop.html?" + urlParams.toString().substring(0, nthIndexOf(initial, "&", 2) + urlParams.toString().indexOf(initial)).replace("pg=" + pageNO, "pg=1") + "&sort=" + value + urlParams.toString().substring(nthIndexOf(initial, "&", 2) + urlParams.toString().indexOf(initial), urlParams.toString().length));
                        }
                    } else {
                        var initial = urlParams.toString().substring(urlParams.toString().indexOf("pg="), urlParams.toString().length);

                        if (nthIndexOf(initial, "&", 1) == undefined) {
                            location.replace("shop.html?" + urlParams.toString().replace("pg=" + pageNO, "pg=1") + "&sort=" + value);
                        } else {
                            location.replace("shop.html?" + urlParams.toString().substring(0, nthIndexOf(initial, "&", 1) + urlParams.toString().indexOf(initial)).replace("pg=" + pageNO, "pg=1") + "&sort=" + value + urlParams.toString().substring(nthIndexOf(initial, "&", 1) + urlParams.toString().indexOf(initial), urlParams.toString().length));
                        }
                    }
                }
            } else {
                if (urlParams.toString().includes("&sort=")) {
                    var initial = urlParams.toString().substring(urlParams.toString().indexOf("&sort="), urlParams.toString().length);
                    if (nthIndexOf(initial, "&", 2) == undefined) {
                        location.replace("shop.html?" + urlParams.toString().replace(initial, "").replace("pg=" + pageNO, "pg=1"));
                    } else {
                        location.replace("shop.html?" + urlParams.toString().replace(initial, "").replace("pg=" + pageNO, "pg=1") + urlParams.toString().substring(nthIndexOf(initial, "&", 2) + urlParams.toString().indexOf(initial), urlParams.toString().length));
                    }
                } else {
                    if (urlParams.toString().includes("&q=")) {
                        var initial = urlParams.toString().substring(urlParams.toString().indexOf("&q="), urlParams.toString().length);

                        if (nthIndexOf(initial, "&", 2) == undefined) {
                            location.replace("shop.html?" + urlParams.toString().replace("pg=" + pageNO, "pg=1"));
                        } else {
                            location.replace("shop.html?" + urlParams.toString().substring(0, nthIndexOf(initial, "&", 2) + urlParams.toString().indexOf(initial)).replace("pg=" + pageNO, "pg=1") + urlParams.toString().substring(nthIndexOf(initial, "&", 2) + urlParams.toString().indexOf(initial), urlParams.toString().length));
                        }
                    } else {
                        var initial = urlParams.toString().substring(urlParams.toString().indexOf("pg="), urlParams.toString().length);

                        if (nthIndexOf(initial, "&", 1) == undefined) {
                            location.replace("shop.html?" + urlParams.toString().replace("pg=" + pageNO, "pg=1"));
                        } else {
                            location.replace("shop.html?" + urlParams.toString().substring(0, nthIndexOf(initial, "&", 1) + urlParams.toString().indexOf(initial)).replace("pg=" + pageNO, "pg=1") + urlParams.toString().substring(nthIndexOf(initial, "&", 1) + urlParams.toString().indexOf(initial), urlParams.toString().length));
                        }
                    }
                }
            }
        }

        function setFocus() {
            dropdown.blur();
        }

        // <-- Products Href -->
        function prodPg(id) {
            location.href = "/product.html?id=" + id;
        }

        // <-- Cookie Consent -->
        let cSection = document.getElementsByClassName("cookies");
        let cCont = cSection[0].children[0];
        checkCookies();

        function checkCookies() {
            if (getCookie("CookieConsent") == null) {
                cFunc("show");
            } else {
                cFunc("hide");
            }
        }

        function acceptCookies() {
            cFunc("hide");
            setCookie("CookieConsent", "true");
        }

        function cFunc(n) {
            if (n == "show") {
                document.getElementsByClassName("cookies")[0].style.visibility = "visible";
                cCont.style.top = parseInt(parseInt(window.innerHeight) - 80) + "px";
            } else if (n == "hide") {
                cCont.style.top = window.innerHeight + "px";
                document.getElementsByClassName("cookies")[0].style.visibility = "hidden";
            }
        }

        function setCookie(key, value) {
            var expires = new Date();
            expires.setTime(expires.getTime() + (10000 * 365 * 24 * 60 * 60));
            document.cookie = key + '=' + value + ';expires=' + expires.toUTCString();
        }

        function getCookie(key) {
            var keyValue = document.cookie.match('(^|;) ?' + key + '=([^;]*)(;|$)');
            return keyValue ? keyValue[2] : null;
        }

        /*// <-- Header Show -->
        let header = document.getElementById("headerr");
        let logo = document.getElementById("logo");
        var lastScroll = document.documentElement.scrollTop;
        window.onscroll = function () {
            doScroll();
        }

        function doScroll() {
            if (document.documentElement.scrollTop > lastScroll) {
                header.style.position = "absolute";
                header.style.opacity = "0%";
                lastScroll = document.documentElement.scrollTop;
                logo.className = "logo-noline";
            } else {
                if (lastScroll > 1070) {
                    header.style.position = "fixed";
                    header.style.opacity = "100%";
                    lastScroll = document.documentElement.scrollTop;
                    logo.className = "logo-line";
                } else {
                    header.style.position = "fixed";
                    logo.className = "logo-noline";
                    header.style.opacity = "100%";
                    lastScroll = document.documentElement.scrollTop;
                }
            }
        }*/

        // <-- Search Bar -->
        let bar = document.getElementById("Searchbar");
        checkForSearchValue();

        function checkForSearchValue() {
            var q = urlParams.get('q');

            if (q != null) {
                bar.value = q;

                if (bar.value == "") {
                    location.replace("/shop.html?" + urlParams.toString().replace("&q=", ""));
                }
            }
        }

        function searchBar(x) {
            var term = x.parentElement.children[0].value;

            if (urlParams.get('q') == null) {
                if (!urlParams.toString().substring(urlParams.toString().indexOf("&"), urlParams.toString().length).includes("pg")) {
                    window.location.replace("/shop.html?pg=1" + "&q=" + term + urlParams.toString().substring(urlParams.toString().indexOf("&"), urlParams.toString().length));
                } else {
                    window.location.replace("/shop.html?pg=1" + "&q=" + term, "_blank");
                }
            } else {
                if (!urlParams.toString().substring(nthIndexOf(urlParams.toString(), "&", 2), urlParams.toString().length).includes("pg")) {
                    location.replace("/shop.html?pg=1" + "&q=" + term + urlParams.toString().substring(nthIndexOf(urlParams.toString(), "&", 2), urlParams.toString().length));
                } else {
                    location.replace("/shop.html?pg=1" + "&q=" + term);
                }
            }
        }

        function nthIndexOf(string, search, n) {
            var myArray = [];
            for (var i = 0; i < string.length; i++) { //loop thru string to check for occurrences
                if (string.slice(i, i + search.length) === search) { //if match found...
                    myArray.push(i); //store index of each occurrence           
                }
            }
            for (i = 0; i < myArray; i++) {}
            return myArray[n - 1]; //first occurrence stored in index 0 
        }

        // <-- Filters -->
        let footer = document.getElementsByClassName("footer")[0];
        var defaultVar = footer.style.marginTop;
        var subtractFactor = 1660;

        function minimizeFilter(object, value) {
            let filter = object.parentElement;
            let parent = document.getElementsByClassName("filters-cont")[0];
            let arrow = object.children[1];

            if (filter.style.paddingBottom == "0px") {
                arrow.innerHTML = '<i class="fas fa-chevron-up"></i>';
                if (parseInt(parent.style.height) < subtractFactor) {
                    filter.style.paddingBottom = value + "px";
                    parent.style.height = parseInt(parseInt(parent.style.height) + parseInt(value)) + "px";
                } else if (parseInt(parent.style.height) >= subtractFactor) {
                    filter.style.paddingBottom = value + "px";
                    parent.style.height = parseInt(parseInt(parent.style.height) + parseInt(value)) + "px";
                    footer.style.marginTop = parseInt(parseInt(footer.style.marginTop) + parseInt(parseInt(value) + 100)) + "px";
                }
            } else {
                arrow.innerHTML = '<i class="fas fa-chevron-down"></i>';
                if (parseInt(parent.style.height) < subtractFactor) {
                    filter.style.paddingBottom = "0px";
                    parent.style.height = parseInt(parseInt(parent.style.height) - parseInt(value)) + "px";
                    footer.style.marginTop = defaultVar;
                } else if (parseInt(parent.style.height) >= subtractFactor) {
                    filter.style.paddingBottom = "0px";
                    parent.style.height = parseInt(parseInt(parent.style.height) - parseInt(value)) + "px";
                    footer.style.marginTop = parseInt(parseInt(footer.style.marginTop) - parseInt(parseInt(value) + 100)) + "px";
                    if (parseInt(parent.style.height) < parseInt(subtractFactor + 150)) {
                        footer.style.marginTop = defaultVar;
                    }
                }
            }
        }

        function addFilter(object, type) {
            var value = object.children[1].textContent;

            if (value == "Others") {
                if (object.id == "") {
                    if (urlParams.toString().includes(type)) {
                        location.replace("/shop.html?" + urlParams.toString().slice(0, urlParams.toString().indexOf(type + "=") + type.length + 1).replace("pg=" + pageNO, "pg=1") + type.substring(0, 2) + value + "+" + urlParams.toString().slice(urlParams.toString().indexOf("&" + type + "=") + type.length + 2, urlParams.toString().length));
                    } else {
                        location.replace("/shop.html?" + urlParams.toString().replace("pg=" + pageNO, "pg=1") + "&" + type + "=" + type.substring(0, 2) + value);
                    }
                } else {
                    if (urlParams.toString().includes(type + "=" + type.substring(0, 2) + value) && !urlParams.toString().includes(type + "=" + type.substring(0, 2) + value + "+")) {
                        var iable = urlParams.toString().replace("&" + type + "=" + type.substring(0, 2) + value, "");
                        location.replace("/shop.html?" + iable.replace("pg=" + pageNO, "pg=1"));
                    } else if (urlParams.toString().includes(type.substring(0, 2) + value + "+")) {
                        location.replace("/shop.html?" + urlParams.toString().replace(type.substring(0, 2).replace("pg=" + pageNO, "pg=1") + value + "+", ""));
                    } else if (urlParams.toString().includes("+" + type.substring(0, 2) + value)) {
                        location.replace("/shop.html?" + urlParams.toString().replace("+" + type.substring(0, 2).replace("pg=" + pageNO, "pg=1") + value, ""));
                    }
                    object.id = "";
                }
            } else {
                if (object.id == "") {
                    if (urlParams.toString().includes(type)) {
                        location.replace("/shop.html?" + urlParams.toString().slice(0, urlParams.toString().indexOf(type + "=") + type.length + 1).replace("pg=" + pageNO, "pg=1") + value + "+" + urlParams.toString().slice(urlParams.toString().indexOf("&" + type + "=") + type.length + 2, urlParams.toString().length));
                    } else {
                        location.replace("/shop.html?" + urlParams.toString().replace("pg=" + pageNO, "pg=1") + "&" + type + "=" + value);
                    }
                } else {
                    var newVal;
                    newVal = value;
                    if (value.includes(" ")) {
                        newVal = value.replaceAll(" ", "+");
                    }

                    if (decodeURIComponent(urlParams.toString()).includes(type + "=" + newVal) && !decodeURIComponent(urlParams.toString()).includes(type + "=" + newVal + "+")) {
                        var iable = decodeURIComponent(urlParams.toString()).replace("&" + type + "=" + newVal, "");
                        location.replace("/shop.html?" + iable.replace("pg=" + pageNO, "pg=1"));
                    } else if (urlParams.toString().includes(newVal + "+")) {
                        location.replace("/shop.html?" + urlParams.toString().replace(newVal + "+", "").replace("pg=" + pageNO, "pg=1"));
                    } else if (urlParams.toString().includes("+" + newVal)) {
                        location.replace("/shop.html?" + urlParams.toString().replace("+" + newVal, "").replace("pg=" + pageNO, "pg=1"));
                    }
                    object.id = "";
                }
            }
        }

        function clearFilters() {
            if (urlParams.toString().includes("sort") && urlParams.toString().includes("q")) {
                location.replace("/shop.html?" + urlParams.toString().substring(0, nthIndexOf(urlParams.toString(), "&", 3)).replace("pg=" + pageNO, "pg=1"));
            } else if (urlParams.toString().includes("q") || urlParams.toString().includes("sort")) {
                location.replace("/shop.html?" + urlParams.toString().substring(0, nthIndexOf(urlParams.toString(), "&", 2)).replace("pg=" + pageNO, "pg=1"));
            } else {
                location.replace("/shop.html?" + urlParams.toString().substring(0, urlParams.toString().indexOf("&")).replace("pg=" + pageNO, "pg=1"));
            }
        }

        checkFilter();

        function checkFilter() {
            let allObjs = document.getElementsByClassName("checkbox-cat");

            for (i = 0; i < allObjs.length; i++) {
                var value = allObjs[i].children[1].textContent;
                var type = allObjs[i].onclick.toString().substring(nthIndexOf(allObjs[i].onclick.toString(), "'", 1) + 1, nthIndexOf(allObjs[i].onclick.toString(), "'", 2))

                var category = urlParams.get(type);

                if (category != null) {
                    if (value == "Others") {
                        if (category.includes(type.substring(0, 2) + value)) {
                            allObjs[i].children[0].children[0].className = "Checked";
                            allObjs[i].id = "enabledFilter";
                        }
                    } else {
                        if (category.includes(value)) {
                            allObjs[i].children[0].children[0].className = "Checked";
                            allObjs[i].id = "enabledFilter";
                        }

                        if (category.includes(value.substr(0, value.length - 1) + '%22')) {
                            allObjs[i].children[0].children[0].className = "Checked";
                            allObjs[i].id = "enabledFilter";
                        }

                        if (category.includes(value.replaceAll(" ", "+"))) {
                            allObjs[i].children[0].children[0].className = "Checked";
                            allObjs[i].id = "enabledFilter";
                        }
                    }
                }
            }
        }

        defaultFilterMinimize();

        function defaultFilterMinimize() {
            let rows = document.getElementsByClassName("row");
            let parentt = document.getElementsByClassName("filters-cont")[0];
            var actualRows = [];

            for (i = 0; i < rows.length; i++) {
                if (rows[i].parentElement.className == "small-container") {
                    actualRows.push(rows[i]);
                }
            }

            var varvar = actualRows.length - 1;
            if (varvar == 1) {
                minimizeFilter(parentt.children[1].children[0], '250');
                minimizeFilter(parentt.children[2].children[0], '250');
            } else if (varvar == 2) {
                minimizeFilter(parentt.children[2].children[0], '250');
            } else if (varvar == 3) {
                minimizeFilter(parentt.children[3].children[0], '250');
            } else if (varvar == 4) {
                minimizeFilter(parentt.children[3].children[0], '250');
                minimizeFilter(parentt.children[4].children[0], '250');
            }

            footer.style.marginTop = parseInt(parseInt(footer.style.marginTop) - parseInt(400 * parseInt(4 - varvar))) + "px";
            defaultVar = footer.style.marginTop;
            subtractFactor = 1660 / parseInt(5 - varvar);
        }
    // <-- Side Navigation -->

        function Nav() {
            if (document.getElementById("indexpage").style.transform == "") {
                document.getElementById("Sidenav").style.transform = "translateX(0px)";
                document.getElementById("indexpage").style.transform = "translateX(300px)";
                document.body.style.overflowY = 'hidden';
                document.body.style.overflowX = 'hidden';
                setTimeout(function() {
                    document.getElementById("indexpage").setAttribute('onclick', 'Nav()');
                }, 150);
            } else {
                document.getElementById("Sidenav").style.transform = "translateX(-300px)";
                document.getElementById("indexpage").style.transform = "";
                document.body.style.overflowY = '';
                document.body.style.overflowX = '';
                setTimeout(function() {
                    document.getElementById("indexpage").setAttribute('onclick', '');
                }, 150);
            }
        }

        // <-- Side Navigation Open List -->
        function navList(object, value) {
            var obj = object.parentElement.parentElement.children[1];

            if (obj.style.marginBottom == "0px") {
                obj.style.marginBottom = value + "px";
                object.innerHTML = "+";
            } else {
                obj.style.marginBottom = "0px";
                object.innerHTML = "-";
            }
        }

        
        
        
        

    </script>
</body>

</html>